# ST008 - 成員調度與待處理池 (Member Transfer & Pending Pool)

**ID**: ST-008  
**Priority**: Must Have (Core Feature)  
**Phase**: 3 - 組織架構管理  
**Status**: 🔲 規劃中

## 簡述
實作會友在牧區/小組間的調度轉移功能，包含拖拉分配、點擊分配、批次分配等多種操作方式，並管理「已註冊但未歸屬小組」的待處理池。

## 核心功能
- **拖拉分配 (Drag & Drop)**
  - 從待處理池拖拉會友至 Tree View 的小組節點
  - 拖拉互動反饋（游標變更、目標高亮）
  - 拖拉驗證（僅小組節點可放置）

- **點擊分配 (Quick Assign)**
  - 點擊待處理池會友卡片開啟快速分配對話框
  - 牧區小組連動選擇器
  - 分配後自動更新待處理池與 Tree View

- **批次分配 (Batch Assignment)**
  - 勾選多位會友（Checkbox）
  - 批次分配至同一牧區與小組
  - 部分成功策略（失敗不回滾，顯示詳細錯誤）
  - 單次最多 50 位會友

- **成員轉移 (Member Transfer)**
  - 轉移會友到其他牧區/小組
  - 記錄原歸屬與新歸屬
  - 轉移確認對話框

- **轉移歷史記錄 (Audit Log, 預留)**
  - 記錄所有分配與轉移操作
  - 僅實作 API 寫入，查詢介面由 ST027 負責

## 關鍵 AC
- 拖拉到牧區節點顯示錯誤（必須選擇小組）
- 批次分配採用「部分成功」策略
- 分配時驗證小組是否屬於該牧區
- Zone Scope 僅能分配會友到自己的牧區
- 所有操作顯示 Toast 確認訊息

## 依賴項
- ✅ **ST001**: 資料核心與 Schema 定義 (members, zones, groups collections)
- ✅ **ST002**: RBAC Configuration (member:edit, org:manage 權限)
- ✅ **ST003**: 會友資料列表（提供會友資料與 API）
- ✅ **ST006**: 牧區與小組管理（提供牧區/小組資料與 API）
- ✅ **ST007**: 組織架構三 Tab 介面（提供拖拉目標與待處理池）

## 相關 Stories
- **ST003**: 會友資料列表（提供會友資料）
- **ST006**: 牧區與小組管理（提供牧區/小組資料）
- **ST007**: 組織架構三 Tab 介面（提供拖拉目標與待處理池）
- **ST027**: 審計日誌（實作轉移歷史記錄的查詢介面）

## 文件
- [詳細需求](./Description.md)
- [技術設計](./Technical%20Design.md)
- [問題與澄清](./Questions.md)
